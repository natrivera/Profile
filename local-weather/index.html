<!DOCTYPE html>
<html>
<head>
<title>Local Weather</title>
<meta name="description" content="A page to display the local weather created by Nat Rivera">
<meta name="keywords" content="Nat Rivera">

<style>
body {
  background-color: #36454f; 
  font:400 100%/1.3 'Oleo Script', Helvetica, sans-serif;
  color: #FFFFFF;
  text-shadow: 4px 4px 0px rgba(0,0,0,0.1);
}
.title {
  text-align: center;
  font-size: 200%;
}
.info {
  text-align: center;
  font-size: 150%;
}
img {
  width: 40%;
  height: 40%;
  margin: -15% 0% -5% 0%;
  
}
.display {
  background-color: #000000;
  margin: auto;
  width: 70%;
  border-radius: 10px;
  border: solid 4px #2d2d2d;
}
.temperature li {
  list-style: none;
  display: inline-block;
  padding-right: 1%;
  margin: -15% 2% 0% 0%;
}
#kfc:hover {
  color: #0000ff;  
}
#weatherType {
  font-size: 200%;
  margin-top: -05%;
  margin-bottom: 0%;
}
button {
  background-color: transparent;
  color: #FFFFFF;
  font-size: 150%;
  border-color: transparent;
}

</style>
</head>

<body>
<link href='https://fonts.googleapis.com/css?family=Oleo+Script' rel='stylesheet' type='text/css'>
<div class="title">
  <h1>Local Weather </h1>
</div>
<div class="info">
  <h2 id="city">Your City</h2>
  <div class="display">
    <div class="temperature"><ul>
      <li><h2 id="temp">???</h2></li><li><h2 id= "kfc">&degF</h2></li>
      </ul>
    </div>
    <i class="wi wi-night-sleet"></i>
    <div id="iconId"><img src = "https://openweathermap.org/img/w/01d.png"></div>
    <p id="weatherType">Condition</p>
  </div>
  <div id="data">
  </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

<script>
$(document).ready(function() {
  var data = document.getElementById("data");
  var lat;
  var long;
  var region;
  var ftemp;
  var ctemp;
  var city;
  var icon;
  var iconId;
  var weatherType;
  var label;
  var ktemp;
  var ftemp;
  var ctemp;
  var speed;
  var dtemp;
  var iconP;
  var locApi = "https://freegeoip.net/json/";
  var iconApi = 'https://gist.githubusercontent.com/tbranyen/62d974681dea8ee0caa1/raw/3405bfb2a76b7cbd90fde33d8536f0cd13706955/icons.json';
  //var iconP = ("<img src='https://openweathermap.org/img/w/" + icon + ".png'>");
  $.getJSON(locApi, function(pos) {
    lat = pos.latitude;
    long = pos.longitude;
    region = pos.region_code;
    var wapi = "http://api.openweathermap.org/data/2.5/weather?lat=" + lat + "&lon=" + long + "&appid=6ee606a8d671c5b28060f5bd4eb31d7c";
    
    $.getJSON(wapi, function(num) {
      city = num.name;
      weatherType = num.weather[0].description;
      icon = num.weather[0].icon;
      label = num.weather[0].id;
      ktemp = num.main.temp;
      speed = num.wind.speed;
      ftemp = Math.round((ktemp * (9 / 5)) - 459.67);
      ctemp = Math.round(ktemp - 273);
      $("#temp").html(ftemp);
      $("#weatherType").html(weatherType);
      $("#speed").html(speed);
      $("#city").html(city + ", " + region);
      $("#icon").html(icon);
      $("#label").html(label);
      dtemp = ftemp;
     // iconId = weatherIcons[label].icon;
      iconP = ("<img src='https://openweathermap.org/img/w/" + icon + ".png'>");
      $("#iconId").html(iconP);
    });

//console.log(wapi);
//console.log(icon);
  });
  $("#kfc").click(function() {
    if (dtemp === ftemp) {
      $("#kfc").html("&degC");
      $("#temp").html(ctemp);
      dtemp = ctemp;
    } else {
      $("#kfc").html("&degF");
      $("#temp").html(ftemp);
      dtemp = ftemp;
    }

  });

});
</script>
</body>
</html>
